<!DOCTYPE html>
<html>

<head>
    <title>Admin</title>
    <!-- Added link to the jQuery Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Added a link to Bootstrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

    <script src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0" type="text/javascript" charset="UTF-8"></script>
</head>

<body>

    <div>
        <div class="jumbotron">

            <h1 class="text-center">Show the Orders</h1>

            <div class="text-center" id="stuff">

                <!-- Here we have our button with id random-button -->
                <button id="order-button" class="btn btn-primary btn-lg">
                    <h1>ORDERS</h1>
                </button>

            </div>

        </div>

        <div class="text-center" id="new-order">


        </div>
        <br>

        <div class="jumbotron">

            <h1 class="text-center">Show Map</h1>

            <div class="text-center">

                <!-- Here we have our button with id random-button -->
                <button id="map-button" class="btn btn-primary btn-lg">
                    <h1>MAP</h1>
                </button>
            </div>
        </div>

    </div>

    <div class="text-center" id="map" style="position: center; width: 1475px; height: 500px;"></div>
</body>

</body>

<script>

    var pinInfobox;
    $("#map-button").on("click",
        function GetMap() {
            var num = 13;
            var order = num.toString();

            var pushpinInfos = [];
            pushpinInfos[0] = { 'lat': 39.620020, 'lng': -104.896038, 'title': '5300 DTC Pkwy', 'description': order };
            pushpinInfos[1] = { 'lat': 39.613071, 'lng': -104.894307, 'title': '5613 DTC PKWY', 'description': 'Glass Building, enter through back enterence', 'orders': 3 };
            pushpinInfos[2] = { 'lat': 39.618144, 'lng': -104.896345, 'title': '4601 DTC PKWY', 'description': 'Black Building, front lobby', 'orders': 5 };

            var infoboxLayer = new Microsoft.Maps.EntityCollection();
            var pinLayer = new Microsoft.Maps.EntityCollection();
            var apiKey = "AtWJG1uzq4rqQaftoe2MQVzNJN2SVic1QXgBO-5oaJsBRaHC2osRfoUKbvYBordM";

            var map = new Microsoft.Maps.Map(document.getElementById("map"), { credentials: apiKey });

            // Create the info box for the pushpin
            pinInfobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0, 0), { visible: false });
            infoboxLayer.push(pinInfobox);

            var locs = [];
            for (var i = 0; i < pushpinInfos.length; i++) {
                locs[i] = new Microsoft.Maps.Location(pushpinInfos[i].lat, pushpinInfos[i].lng);
                var pin = new Microsoft.Maps.Pushpin(locs[i]);
                pin.Title = pushpinInfos[i].title;
                pin.Description = pushpinInfos[i].description;
                pin.Text = pushpinInfos[i].description;
                pinLayer.push(pin);
                Microsoft.Maps.Events.addHandler(pin, 'click', displayInfobox);
            }

            map.entities.push(pinLayer);
            map.entities.push(infoboxLayer);

            var bestview = Microsoft.Maps.LocationRect.fromLocations(locs);
            map.setView({ center: bestview.center, zoom: 10 });
        });

    function displayInfobox(e) {
        pinInfobox.setOptions({ title: e.target.Title, description: e.target.Description, visible: true, offset: new Microsoft.Maps.Point(0, 25) });
        pinInfobox.setLocation(e.target.getLocation());
    }

    function hideInfobox(e) {
        pinInfobox.setOptions({ visible: false });
    }


    $("#order-button").on("click", function () {
        $.get("/api/orders", function (data) {
            console.log(data);
            for (i = 0; i < 100; i++) {

                $("#new-order").append($("<div>" + "ORDER FOR: " + JSON.stringify(data[i].name) + "<br>" + " SANDWICHES: " + JSON.stringify(data[i].sandwiches) + "<br>"  + " DRINKS: " + JSON.stringify(data[i].drinks) +"<br>" + " SIDES: " + JSON.stringify(data[i].sides) + "<br>" + "-------" + "<br>" + "</div>"))}
            });
        });







</script>

</html>